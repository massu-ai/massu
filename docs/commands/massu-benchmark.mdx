---
title: "/massu-benchmark"
description: "Performance benchmarking with baseline capture and regression detection across bundle size, test suite duration, and build time"
order: 26
---

# /massu-benchmark

A read-only performance benchmarking command that captures performance baselines and compares current metrics against them. It tracks bundle size, test suite duration, TypeScript compilation time, and hook execution times. When a regression is detected, it identifies which change likely caused it.

## What It Does

The benchmark command measures five performance dimensions:

1. **Bundle size** -- Measures the output size of each route's JavaScript bundle and compares against the stored baseline
2. **Test suite duration** -- Runs the vitest suite in benchmark mode and records per-file execution times
3. **TypeScript compilation time** -- Times `tsc --noEmit` and flags increases from baseline
4. **Build time** -- Times the full `npm run build` and records component timings
5. **Hook execution times** -- Measures each hook's average execution time to ensure they stay under 500ms

Results are stored in the memory database as a benchmark snapshot. Future runs compare against the most recent snapshot.

## Usage

Run all benchmarks and compare against baseline:

```
/massu-benchmark
```

Capture a new baseline (after a confirmed performance improvement):

```
/massu-benchmark --set-baseline
```

Benchmark only bundle size:

```
/massu-benchmark --only bundle
```

Output as JSON for CI integration:

```
/massu-benchmark --json
```

## Output

```
## Benchmark Report
Compared against baseline: 2026-02-10

### Bundle Size
| Route | Current | Baseline | Delta | Status |
|-------|---------|----------|-------|--------|
| / (homepage) | 82KB | 80KB | +2KB (+2.5%) | OK |
| /dashboard | 145KB | 128KB | +17KB (+13.3%) | WARN |
| /orders | 98KB | 97KB | +1KB (+1%) | OK |

WARNING: /dashboard increased by 13.3% since baseline
Likely cause: commit a3f2e1 (2026-02-14) added recharts dependency

### Test Suite Duration
- Total: 8.2s (baseline: 7.4s, +0.8s)
- Slowest file: src/__tests__/orders.test.ts (2.1s, was 1.8s)

### TypeScript Compilation
- Duration: 4.1s (baseline: 4.0s, delta: +0.1s — within tolerance)

### Build Time
- Total: 22s (baseline: 21s, +1s — within tolerance)

### Hook Execution Times
| Hook | Avg | Max | Limit | Status |
|------|-----|-----|-------|--------|
| session-start | 42ms | 89ms | 500ms | OK |
| post-tool-use | 18ms | 34ms | 500ms | OK |
| cost-tracker | 6ms | 12ms | 500ms | OK |

### Summary
- 1 regression detected (bundle size: /dashboard)
- Recommended action: audit recharts import, consider lazy loading
```

## Tips

- Set a new baseline after confirmed optimizations with `--set-baseline` -- never set a baseline on a regression
- The bundle size `WARN` threshold defaults to 10% increase -- configure in `massu.config.yaml` under `benchmark.bundleWarnPercent`
- Use `/massu-benchmark` before and after adding a major dependency to measure its actual size impact
- The `--json` flag produces output suitable for CI systems that track performance metrics over time
- Combine with `/massu-perf` for actionable optimization recommendations after identifying a regression
- Hook execution time benchmarks help catch accidental database query additions to hooks before they slow down sessions
