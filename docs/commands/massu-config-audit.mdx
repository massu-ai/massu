---
title: "/massu-config-audit"
description: "Config validation audit verifying config-code alignment and config map fallback defaults"
order: 30
---

# /massu-config-audit

A read-only audit that validates configuration values align with code expectations and that all config map lookups have proper fallback defaults. Catches silent runtime failures caused by config-code mismatches.

## Usage

```
/massu-config-audit
```

## What It Does

The audit operates on the principle that a config file with wrong keys is worse than no config at all -- it silently fails at runtime with a crash. The command runs 6 validation sections.

### Section 1: Config Schema Validation
Parses `massu.config.yaml` and verifies it is valid YAML. Extracts all config keys and cross-references them against `getConfig()` property accesses in code to confirm every accessed property exists in the config file.

### Section 2: Fallback Default Audit
Identifies all config map lookups with dynamic keys (e.g., `CONFIG_MAP[status]`) and verifies each has a fallback default. A lookup like `CONFIG_MAP[dynamicKey].label` crashes when the key does not exist. The correct pattern requires a fallback: `(CONFIG_MAP[status] || CONFIG_MAP.default).label`.

### Section 3: Tool Prefix Consistency
Verifies all tool names use the config-driven prefix via `getConfig().toolPrefix` and that no hardcoded `massu_` prefixes exist in source code. Checks the `stripPrefix()` and `p()` helper functions are used consistently.

### Section 4: Config File Completeness
Checks all expected top-level config sections exist and identifies config keys referenced in code that may be missing from the config file.

### Section 5: Environment Variable Audit
Finds all `process.env` references in source code and verifies each environment variable is documented.

### Section 6: Mismatch Report
Produces a summary of all findings categorized as:
- **Critical Mismatches**: Config values that will cause runtime crashes
- **Missing Fallbacks**: Config map lookups without safe defaults
- **Missing Config Entries**: Keys referenced in code but absent from config

## Completion Criteria

The audit passes when:
- `massu.config.yaml` parses without errors
- All config properties accessed in code exist in the config file
- All config map lookups have fallback defaults
- Tool prefix is consistently config-driven
- All environment variables are documented
- Zero mismatches remain

## When to Use

- **After config changes**: Verify new config values align with code expectations
- **When debugging runtime crashes**: Config-code mismatches are a common cause of silent failures
- **After adding new tool modules**: Ensure tool prefixes use config-driven values
- **Periodic maintenance**: Catch config drift before it causes production issues
