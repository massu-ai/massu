---
title: "/massu-incident"
description: "Automated incident post-mortem with prevention pipeline"
order: 33
---

# /massu-incident

An automated incident post-mortem protocol that logs the incident, records it in session state, proposes prevention rules, and updates relevant audit protocols. Designed for bugs that an existing audit should have caught but did not.

## Usage

```
/massu-incident
```

The command will prompt for a description of what went wrong and how it was discovered.

## Workflow Steps

### Step 1: Capture Incident Details
Gathers the full incident context: what happened, root cause, how it was discovered (user, audit, or automated), impact, files involved, which audit should have caught it, and why the audit missed it.

### Step 2: Determine Incident Number
Reads the existing incident log to assign the next sequential incident number.

### Step 3: Log to Incident Log
Appends a structured entry to `.claude/incidents/INCIDENT-LOG.md` with date, severity, root cause, files involved, and the prevention measures added.

### Step 4: Record in Session State
Updates `.claude/session-state/CURRENT.md` with the incident details at importance level 5 (critical), ensuring it surfaces in future sessions.

### Step 5: Propose Prevention
Generates up to four prevention measures:
- **New CR rule**: If the failure mode is not covered by existing canonical rules
- **New VR check**: Every incident must produce a verifiable check command
- **Pattern scanner rule**: If the bad pattern is detectable by grep, adds it to `scripts/massu-pattern-scanner.sh`
- **Protocol update**: Adds an incident reminder section to the protocol that should have caught the bug

### Step 6: Update CLAUDE.md
Updates the incident count and adds a row to the incident summary table.

### Step 7: Verify Prevention Works
Runs the pattern scanner and any new verification checks to confirm the prevention measures catch the original failure.

### Steps 8-10: Learning and Codebase Sweep
Records the wrong vs. correct pattern in session state, searches the entire codebase for the same bad pattern (CR-9), and verifies tool registration if applicable (CR-11).

## Output

The command produces a post-mortem summary showing:
- Where the incident was logged
- Which CR and VR rules were added or updated
- Whether a pattern scanner rule was added
- Which protocol was updated
- The 4-level prevention chain (session state, pattern scanner, protocol, CR rule)

## When to Use

- **When a bug is found that audits should have caught**: The primary trigger for this command
- **After production incidents**: Document the failure and prevent recurrence
- **When the same bug appears twice**: Evidence that auto-learning failed and stronger prevention is needed
